f <- "cvf_neomorb.csv"
d <- read.csv(f)
str(d)
d$Neomorb_Composite <- factor(d$Neomorb_Composite, labels=c("Yes", "No"))
table(d$Neomorb_Composite, unclass(d$Neomorb_Composite))
xVarNames <- names(d)[grep("^CVF", names(d))]
xVars <- paste(c("Gest_Age", xVarNames), collapse=" + ")
f <- paste("Neomorb_Composite", xVars, sep=" ~ ")
f <- formula(f)
f
packages <- c("ggplot2", "xtable", "rpart", "party", "randomForest")
sapply(packages, require, character.only=TRUE, quietly=TRUE)
m3 <- randomForest(f, data=d)
m3
MeanDecreaseGini <- importance(m3)
rank <- order(MeanDecreaseGini, decreasing=TRUE)
cbind(MeanDecreaseGini, rank)
importance <- cbind(MeanDecreaseGini, rank)
importance[importance$rank <= 5]
importance[importance$rank <= 5, ]
importance <- data.frame(MeanDecreaseGini, rank)
importance[importance$rank <= 5, ]
?order
rank <- sort(MeanDecreaseGini, decreasing=TRUE)
importance <- data.frame(MeanDecreaseGini, rank)
head(importance)
rank <- order(MeanDecreaseGini, decreasing=TRUE)
importance <- data.frame(MeanDecreaseGini, rank)
head(importance)
importance
MeanDecreaseGini
names(MeanDecreaseGini)
xVarNames <- names(d)[grep("^CVF", names(d))]
xVarNames <- c("Gest_Age", xVarNames)
xVars <- paste(xVarNames, collapse=" + ")
f <- paste("Neomorb_Composite", xVars, sep=" ~ ")
f <- formula(f)
f
xVarNames
MeanDecreaseGini <- as.vector(importance(m3))
rank <- order(MeanDecreaseGini, decreasing=TRUE)
importance <- data.frame(xVarNames, MeanDecreaseGini, rank)
head(importance)
importance
rank <- order(MeanDecreaseGini)
importance <- data.frame(xVarNames, MeanDecreaseGini, rank)
head(importance)
importance
importance[rank, ]
MeanDecreaseGini <- as.vector(importance(m3))
rank <- order(MeanDecreaseGini, decreasing=TRUE)
importance <- data.frame(xVarNames, MeanDecreaseGini, rank)
importance[rank, ]
m3 <- randomForest(f, data=d)
m3
MeanDecreaseGini <- as.vector(importance(m3))
rank <- order(MeanDecreaseGini, decreasing=TRUE)
importance <- data.frame(xVarNames, MeanDecreaseGini, rank)
importance[rank, ]
importance <- importance(m3)
head(importance[order(importance)])
head(importance[order(importance), ])
importance <- importance(m3)
head(importance[order(importance), ])
head(importance[order(importance, decreasing=TRUE), ])
head(importance[order(importance, decreasing=TRUE) & importance > 1, ])
head(importance[order(importance[importance > 1], decreasing=TRUE), ])
importance[importance > 1]
importance[importance > 1, ]
importance[importance > 1, ][order(importance[importance > 1, ])
)
importance[importance > 1, ][order(importance[importance > 1, ], decreasing=TRUE)]
xSubset <- importance[importance > 1, ][order(importance[importance > 1, ], decreasing=TRUE)]
xSubset
xSubset <- names(xSubset)
xSubset
f <- paste("Neomorb_Composite", paste(xSubset, collapse=" + "), sep=" ~ ")
f <- formula(f)
f
m4 <- glm(f, data=d, family=binomial)
summary(m4)
install.packages("pROC")
margin(m3)
plot(m3)
plot.margin(m3)
plot(margin(m3))
varImpPlot(m3)
treesize(m3)
combine(m3)
print(m3)
m3 <- randomForest(f, data=d, do.trace=10)
require(pROC
)
xSubset <- importance[importance > 1, ][order(importance[importance > 1, ], decreasing=TRUE)]
xSubset
xSubset <- names(xSubset)
f <- paste("Neomorb_Composite", paste(xSubset, collapse=" + "), sep=" ~ ")
f <- formula(f)
f
m4 <- glm(f, data=d, family=binomial)
summary(m4)
roc(f, data=d)
plot(roc(f, data=d))
f
roc <- roc(f, data=d)
names(roc)
head(roc)
plot(roc)
plot.roc(roc)
auc(roc)
auc(f, data=d)
m4yhat <- predict(m4)
plot(roc(d$Neomorb_Composite, m4yhat))
m3yhat <- predict(m3)
plot(roc(d$Neomorb_Composite, m3yhat))
m3yhat
plot(roc(d$Neomorb_Composite, unclass(m3yhat)))
plot(roc(d$Neomorb_Composite, predict(m4)))
